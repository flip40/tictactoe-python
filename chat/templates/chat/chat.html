{% extends 'base.html' %}

{% block body %}
<div>
	<div id="chatbox">
		
	</div>
	<div>
		<input id="message" type="text" />
		<button onclick="sendmessage()">Send</button>
	</div>
</div>
{% endblock %}

{% block scripts %}
<script type="text/javascript">
	//set update on timer
	setTimeout(function() {
		//clear old messages (should change to just add new messages instead of add all, will improve)
		$("#chatbox").empty();
		//ajax to check for new messages
		$.ajax({
			url: "{% url 'chat:updatechat' %}",
			dataType: "json",
			success: function(json) {
				$("#chatbox").append("<span>"++"</span>");
			},
		});
	}, 100);
	
	//send message
	function sendmessage() {
		var message = $("#message").val();
		$("#message").val("");
		
		//ajax send message
		$.ajax({
			url: "{% url 'chat:sendmessage' %}",
			type: "POST",
			data: {message: message}
		});
	}
</script>
{% endblock %}
